title: Suspicious Parent-Child Process Relationships
id: proc-suspicious-parent-child
status: experimental
description: Detects suspicious parent-child process relationships often used in attacks (e.g., shells spawned by web servers, editors, or database processes)
references:
  - https://attack.mitre.org/techniques/T1059/
author: Copilot
logsource:
  product: linux
  service: process
fields:
  - name
  - parent
  - cmdline
detection:
  selection:
    parent|in:
      - 'nginx'
      - 'apache2'
      - 'mysqld'
      - 'postgres'
      - 'sshd'
    name|in:
      - 'bash'
      - 'sh'
      - 'zsh'
      - 'python'
      - 'perl'
  condition: selection
falsepositives:
  - Debugging or admin scripts
level: high