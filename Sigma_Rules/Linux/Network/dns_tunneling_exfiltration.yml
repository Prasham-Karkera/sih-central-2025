title: DNS Tunneling or Exfiltration
id: custom-dns-tunnel
status: experimental
description: Detects high-volume or suspicious DNS queries (potential tunneling or exfiltration)
references:
  - https://attack.mitre.org/techniques/T1048/
author: Copilot
logsource:
  product: linux
  service: network
  category: dns
fields:
  - process
  - remote_address
  - type
  - query
  - count
  - timestamp
detection:
  selection:
    query|contains:
      - '.xyz'
      - '.top'
      - '.tk'
    count|gte: 100
  condition: selection
falsepositives:
  - Legitimate high-volume DNS
level: high