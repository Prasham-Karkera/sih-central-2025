title: Unencrypted Sensitive Protocols
id: custom-unencrypted-protocols
status: experimental
description: Detects use of unencrypted protocols (FTP, Telnet, HTTP) for sensitive data transfer
references:
  - https://attack.mitre.org/techniques/T1040/
author: Copilot
logsource:
  product: linux
  service: network
  category: connection
fields:
  - process
  - local_port
  - remote_address
  - type
  - timestamp
detection:
  selection:
    local_port|in:
      - 21
      - 23
      - 80
    process|contains:
      - 'ftp'
      - 'telnet'
      - 'curl'
      - 'wget'
  condition: selection
falsepositives:
  - Non-sensitive transfers
level: medium