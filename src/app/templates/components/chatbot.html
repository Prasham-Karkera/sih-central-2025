<!-- Floating Chatbot -->
<div class="fixed bottom-8 right-8 z-50">
    <button onclick="toggleChat()"
        class="w-14 h-14 bg-black dark:bg-white text-white dark:text-black rounded-full shadow-lg flex items-center justify-center text-xl hover:scale-105 transition-transform">
        <i class="fas fa-comment-alt"></i>
    </button>

    <div id="chat-window"
        class="hidden absolute bottom-16 right-0 w-80 h-96 panel rounded-lg shadow-2xl flex flex-col overflow-hidden transition-all duration-300 origin-bottom-right">

        <!-- Chat Background 3D -->
        <div id="chat-bg-canvas" class="absolute inset-0 z-0 pointer-events-none opacity-20"></div>

        <div
            class="p-4 border-b border-gray-200 dark:border-white/10 bg-gray-50 dark:bg-white/5 flex justify-between items-center shrink-0 relative z-10">
            <div class="flex items-center gap-2">
                <div id="chat-3d-container" class="w-8 h-8 rounded-full bg-black/10 dark:bg-white/10 overflow-hidden">
                </div>
                <span class="font-display font-bold text-sm">Sentinel Assistant</span>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="toggleChatFullScreen()" class="opacity-50 hover:opacity-100" title="Toggle Fullscreen">
                    <i class="fas fa-expand" id="chat-expand-icon"></i>
                </button>
                <button onclick="toggleChat()" class="opacity-50 hover:opacity-100">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <div class="flex-1 p-4 overflow-y-auto space-y-3 custom-scrollbar relative z-10" id="chat-messages">
            <div class="flex justify-start">
                <div
                    class="bg-gray-100 dark:bg-white/10 p-3 rounded-lg rounded-tl-none max-w-[85%] text-xs shadow-sm dark:shadow-none">
                    Hello. How can I assist with your security analysis today?
                </div>
            </div>
        </div>
        <div
            class="p-3 border-t border-gray-200 dark:border-white/10 relative z-10 bg-white/50 dark:bg-transparent backdrop-blur-sm">
            <form onsubmit="handleChat(event)" class="flex gap-2">
                <input type="text" id="chat-input" placeholder="Type a command..."
                    class="input-field flex-1 rounded px-3 py-2 text-xs outline-none focus:ring-1 focus:ring-current bg-white dark:bg-white/5">
                <button type="submit"
                    class="bg-black dark:bg-white text-white dark:text-black px-3 rounded hover:opacity-80 transition"><i
                        class="fas fa-paper-plane text-xs"></i></button>
            </form>
        </div>
    </div>
</div>